#pragma once

#include <cassert>
#include "libejovo.hpp"

// Return the values of the erf as computed by matlab over the discretization
// -3, 3, 1000
namespace ejovo {

Matrix<double> get_erf_matlab() {
    return Matrix<double>::from({

-0.99998,-0.99998,-0.99998,-0.99998,-0.99997,-0.99997,-0.99997,-0.99997,-0.99997,-0.99997,-0.99997,-0.99997,-0.99997,-0.99996,-0.99996,-0.99996,-0.99996,-0.99996,-0.99996,-0.99996,-0.99995,-0.99995,-0.99995,-0.99995,-0.99995,-0.99994,-0.99994,-0.99994,-0.99994,-0.99994,-0.99993,-0.99993,-0.99993,-0.99993,-0.99992,-0.99992,-0.99992,-0.99991,-0.99991,-0.99991,-0.9999,-0.9999,-0.9999,-0.99989,-0.99989,-0.99989,-0.99988,-0.99988,-0.99987,-0.99987,-0.99987,-0.99986,-0.99986,-0.99985,-0.99985,-0.99984,-0.99983,-0.99983,-0.99982,-0.99982,-0.99981,-0.9998,-0.9998,-0.99979,-0.99978,-0.99978,-0.99977,-0.99976,-0.99975,-0.99974,-0.99974,-0.99973,-0.99972,-0.99971,-0.9997,-0.99969,-0.99968,-0.99967,-0.99966,-0.99965,-0.99963,-0.99962,-0.99961,-0.9996,-0.99958,-0.99957,-0.99956,-0.99954,-0.99953,-0.99951,-0.9995,-0.99948,-0.99946,-0.99945,-0.99943,-0.99941,-0.99939,-0.99937,-0.99935,-0.99933,-0.99931,-0.99929,-0.99927,-0.99924,-0.99922,-0.99919,-0.99917,-0.99914,-0.99912,-0.99909,-0.99906,-0.99903,-0.999,-0.99897,-0.99894,-0.99891,-0.99888,-0.99884,-0.99881,-0.99877,-0.99873,-0.9987,-0.99866,-0.99862,-0.99857,-0.99853,-0.99849,-0.99844,-0.9984,-0.99835,-0.9983,-0.99825,-0.9982,-0.99815,-0.99809,-0.99804,-0.99798,-0.99792,-0.99786,-0.9978,-0.99774,-0.99767,-0.99761,-0.99754,-0.99747,-0.9974,-0.99732,-0.99725,-0.99717,-0.99709,-0.99701,-0.99692,-0.99684,-0.99675,-0.99666,-0.99657,-0.99647,-0.99638,-0.99628,-0.99617,-0.99607,-0.99596,-0.99585,-0.99574,-0.99562,-0.99551,-0.99538,-0.99526,-0.99513,-0.995,-0.99487,-0.99473,-0.99459,-0.99445,-0.9943,-0.99415,-0.994,-0.99384,-0.99368,-0.99352,-0.99335,-0.99318,-0.993,-0.99282,-0.99263,-0.99244,-0.99225,-0.99205,-0.99185,-0.99164,-0.99143,-0.99122,-0.99099,-0.99077,-0.99054,-0.9903,-0.99006,-0.98981,-0.98956,-0.9893,-0.98904,-0.98877,-0.98849,-0.98821,-0.98792,-0.98763,-0.98733,-0.98702,-0.98671,-0.98639,-0.98607,-0.98573,-0.98539,-0.98504,-0.98469,-0.98433,-0.98396,-0.98358,-0.9832,-0.9828,-0.9824,-0.982,-0.98158,-0.98115,-0.98072,-0.98028,-0.97982,-0.97936,-0.97889,-0.97841,-0.97792,-0.97743,-0.97692,-0.9764,-0.97587,-0.97533,-0.97479,-0.97423,-0.97366,-0.97308,-0.97249,-0.97188,-0.97127,-0.97064,-0.97001,-0.96936,-0.96869,-0.96802,-0.96734,-0.96664,-0.96593,-0.9652,-0.96447,-0.96371,-0.96295,-0.96217,-0.96138,-0.96058,-0.95976,-0.95892,-0.95807,-0.95721,-0.95633,-0.95544,-0.95453,-0.95361,-0.95267,-0.95171,-0.95074,-0.94975,-0.94874,-0.94772,-0.94668,-0.94563,-0.94455,-0.94346,-0.94235,-0.94122,-0.94008,-0.93891,-0.93773,-0.93653,-0.93531,-0.93407,-0.93281,-0.93153,-0.93023,-0.92891,-0.92757,-0.92621,-0.92483,-0.92343,-0.92201,-0.92056,-0.9191,-0.91761,-0.9161,-0.91457,-0.91301,-0.91143,-0.90983,-0.90821,-0.90656,-0.90489,-0.90319,-0.90147,-0.89973,-0.89796,-0.89617,-0.89435,-0.89251,-0.89064,-0.88875,-0.88683,-0.88488,-0.88291,-0.88091,-0.87889,-0.87683,-0.87476,-0.87265,-0.87052,-0.86835,-0.86617,-0.86395,-0.8617,-0.85943,-0.85713,-0.8548,-0.85244,-0.85005,-0.84763,-0.84518,-0.8427,-0.84019,-0.83765,-0.83509,-0.83249,-0.82986,-0.8272,-0.82451,-0.82178,-0.81903,-0.81624,-0.81343,-0.81058,-0.8077,-0.80478,-0.80184,-0.79886,-0.79585,-0.79281,-0.78973,-0.78662,-0.78348,-0.78031,-0.7771,-0.77386,-0.77059,-0.76728,-0.76394,-0.76056,-0.75715,-0.75371,-0.75023,-0.74672,-0.74317,-0.73959,-0.73598,-0.73233,-0.72864,-0.72493,-0.72117,-0.71738,-0.71356,-0.70971,-0.70581,-0.70189,-0.69792,-0.69393,-0.6899,-0.68583,-0.68173,-0.67759,-0.67342,-0.66922,-0.66498,-0.6607,-0.65639,-0.65204,-0.64766,-0.64325,-0.6388,-0.63432,-0.6298,-0.62524,-0.62066,-0.61603,-0.61138,-0.60669,-0.60196,-0.5972,-0.59241,-0.58758,-0.58272,-0.57783,-0.5729,-0.56794,-0.56295,-0.55792,-0.55286,-0.54777,-0.54264,-0.53748,-0.53229,-0.52707,-0.52182,-0.51653,-0.51122,-0.50587,-0.50049,-0.49508,-0.48963,-0.48416,-0.47866,-0.47313,-0.46756,-0.46197,-0.45635,-0.4507,-0.44502,-0.43931,-0.43358,-0.42781,-0.42202,-0.4162,-0.41036,-0.40448,-0.39859,-0.39266,-0.38671,-0.38073,-0.37473,-0.3687,-0.36265,-0.35657,-0.35047,-0.34435,-0.3382,-0.33203,-0.32584,-0.31962,-0.31339,-0.30713,-0.30085,-0.29455,-0.28823,-0.28189,-0.27553,-0.26915,-0.26276,-0.25634,-0.24991,-0.24346,-0.23699,-0.2305,-0.224,-0.21749,-0.21096,-0.20441,-0.19785,-0.19128,-0.18469,-0.17809,-0.17147,-0.16485,-0.15821,-0.15156,-0.1449,-0.13823,-0.13155,-0.12486,-0.11816,-0.11146,-0.10474,-0.098019,-0.09129,-0.084554,-0.077812,-0.071065,-0.064312,-0.057555,-0.050794,-0.044028,-0.03726,-0.030489,-0.023716,-0.016941,-0.010165,-0.0033885,0.0033885,0.010165,0.016941,0.023716,0.030489,0.03726,0.044028,0.050794,0.057555,0.064312,0.071065,0.077812,0.084554,0.09129,0.098019,0.10474,0.11146,0.11816,0.12486,0.13155,0.13823,0.1449,0.15156,0.15821,0.16485,0.17147,0.17809,0.18469,0.19128,0.19785,0.20441,0.21096,0.21749,0.224,0.2305,0.23699,0.24346,0.24991,0.25634,0.26276,0.26915,0.27553,0.28189,0.28823,0.29455,0.30085,0.30713,0.31339,0.31962,0.32584,0.33203,0.3382,0.34435,0.35047,0.35657,0.36265,0.3687,0.37473,0.38073,0.38671,0.39266,0.39859,0.40448,0.41036,0.4162,0.42202,0.42781,0.43358,0.43931,0.44502,0.4507,0.45635,0.46197,0.46756,0.47313,0.47866,0.48416,0.48963,0.49508,0.50049,0.50587,0.51122,0.51653,0.52182,0.52707,0.53229,0.53748,0.54264,0.54777,0.55286,0.55792,0.56295,0.56794,0.5729,0.57783,0.58272,0.58758,0.59241,0.5972,0.60196,0.60669,0.61138,0.61603,0.62066,0.62524,0.6298,0.63432,0.6388,0.64325,0.64766,0.65204,0.65639,0.6607,0.66498,0.66922,0.67342,0.67759,0.68173,0.68583,0.6899,0.69393,0.69792,0.70189,0.70581,0.70971,0.71356,0.71738,0.72117,0.72493,0.72864,0.73233,0.73598,0.73959,0.74317,0.74672,0.75023,0.75371,0.75715,0.76056,0.76394,0.76728,0.77059,0.77386,0.7771,0.78031,0.78348,0.78662,0.78973,0.79281,0.79585,0.79886,0.80184,0.80478,0.8077,0.81058,0.81343,0.81624,0.81903,0.82178,0.82451,0.8272,0.82986,0.83249,0.83509,0.83765,0.84019,0.8427,0.84518,0.84763,0.85005,0.85244,0.8548,0.85713,0.85943,0.8617,0.86395,0.86617,0.86835,0.87052,0.87265,0.87476,0.87683,0.87889,0.88091,0.88291,0.88488,0.88683,0.88875,0.89064,0.89251,0.89435,0.89617,0.89796,0.89973,0.90147,0.90319,0.90489,0.90656,0.90821,0.90983,0.91143,0.91301,0.91457,0.9161,0.91761,0.9191,0.92056,0.92201,0.92343,0.92483,0.92621,0.92757,0.92891,0.93023,0.93153,0.93281,0.93407,0.93531,0.93653,0.93773,0.93891,0.94008,0.94122,0.94235,0.94346,0.94455,0.94563,0.94668,0.94772,0.94874,0.94975,0.95074,0.95171,0.95267,0.95361,0.95453,0.95544,0.95633,0.95721,0.95807,0.95892,0.95976,0.96058,0.96138,0.96217,0.96295,0.96371,0.96447,0.9652,0.96593,0.96664,0.96734,0.96802,0.96869,0.96936,0.97001,0.97064,0.97127,0.97188,0.97249,0.97308,0.97366,0.97423,0.97479,0.97533,0.97587,0.9764,0.97692,0.97743,0.97792,0.97841,0.97889,0.97936,0.97982,0.98028,0.98072,0.98115,0.98158,0.982,0.9824,0.9828,0.9832,0.98358,0.98396,0.98433,0.98469,0.98504,0.98539,0.98573,0.98607,0.98639,0.98671,0.98702,0.98733,0.98763,0.98792,0.98821,0.98849,0.98877,0.98904,0.9893,0.98956,0.98981,0.99006,0.9903,0.99054,0.99077,0.99099,0.99122,0.99143,0.99164,0.99185,0.99205,0.99225,0.99244,0.99263,0.99282,0.993,0.99318,0.99335,0.99352,0.99368,0.99384,0.994,0.99415,0.9943,0.99445,0.99459,0.99473,0.99487,0.995,0.99513,0.99526,0.99538,0.99551,0.99562,0.99574,0.99585,0.99596,0.99607,0.99617,0.99628,0.99638,0.99647,0.99657,0.99666,0.99675,0.99684,0.99692,0.99701,0.99709,0.99717,0.99725,0.99732,0.9974,0.99747,0.99754,0.99761,0.99767,0.99774,0.9978,0.99786,0.99792,0.99798,0.99804,0.99809,0.99815,0.9982,0.99825,0.9983,0.99835,0.9984,0.99844,0.99849,0.99853,0.99857,0.99862,0.99866,0.9987,0.99873,0.99877,0.99881,0.99884,0.99888,0.99891,0.99894,0.99897,0.999,0.99903,0.99906,0.99909,0.99912,0.99914,0.99917,0.99919,0.99922,0.99924,0.99927,0.99929,0.99931,0.99933,0.99935,0.99937,0.99939,0.99941,0.99943,0.99945,0.99946,0.99948,0.9995,0.99951,0.99953,0.99954,0.99956,0.99957,0.99958,0.9996,0.99961,0.99962,0.99963,0.99965,0.99966,0.99967,0.99968,0.99969,0.9997,0.99971,0.99972,0.99973,0.99974,0.99974,0.99975,0.99976,0.99977,0.99978,0.99978,0.99979,0.9998,0.9998,0.99981,0.99982,0.99982,0.99983,0.99983,0.99984,0.99985,0.99985,0.99986,0.99986,0.99987,0.99987,0.99987,0.99988,0.99988,0.99989,0.99989,0.99989,0.9999,0.9999,0.9999,0.99991,0.99991,0.99991,0.99992,0.99992,0.99992,0.99993,0.99993,0.99993,0.99993,0.99994,0.99994,0.99994,0.99994,0.99994,0.99995,0.99995,0.99995,0.99995,0.99995,0.99996,0.99996,0.99996,0.99996,0.99996,0.99996,0.99996,0.99997,0.99997,0.99997,0.99997,0.99997,0.99997,0.99997,0.99997,0.99997,0.99998,0.99998,0.99998,0.99998

    }, 1, 1000);
}

// std::function<double (double)>

};